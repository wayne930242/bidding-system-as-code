package twooverone

import com.github.phisgr.bridge.BiddingTree

/**
 * 1C 開叫及應叫
 * C至少3張，12-21 HCP
 */
fun BiddingTree.oneClub() {
    explanation = "C至少3張（3-3低花時開叫1C），12-21點"

    // 一副高花應叫
    "1D" - "4+D無4張高花，或5+D有開叫實力準備叫出高花" {
        oneDiamondResponseAfterOneClub()
    }

    "1H" - "4+H，5+點" {
        oneMajorResponseAfterMinor()
    }

    "1S" - "4+S，5+點" {
        oneMajorResponseAfterMinor()
    }

    // 無將應叫
    "1N" - "8-10點，均衡型，無4張高花"
    "2N" - "12-15點，均衡型，無4張高花"
    "3N" - "15-18點，均衡型，無4張高花"

    // 反常低花加叫
    "2C" - "反常加叫：9+點，4+C支持，迫叫一輪，無4張高花" {
        invertedMinorRaise()
    }

    "3C" - "阻擊性加叫：5-9點，5+C支持，無4張高花" {
        "Pass" - "低限，不進局"
        "3N" - "19-20點均衡型"
    }

    // 朗·費爾德曼2D應叫
    "2D" - "費爾德曼約定：低花好牌滿貫意圖（6+D強排組或5-5雙低花）" {
        feldman2D()
    }

    // 阻擊性跳叫新花色
    "2H" - "阻擊：6張H排組，3-6點"
    "2S" - "阻擊：6張S排組，3-6點"
    "3D" - "阻擊：7張D排組"
    "3H" - "阻擊：7張H排組"
    "3S" - "阻擊：7張S排組"

    // 二蓋一應叫（進局迫叫）
    // 注意：1C後2C是反常加叫，不是二蓋一
}

/**
 * 1C-1D後的開叫者再叫
 */
private fun BiddingTree.oneDiamondResponseAfterOneClub() {
    "1H" - "4+H，可能非均衡型或雙張小牌高花" {
        "1S" - "4S，開叫實力，還有5+D"
        "1N" - "5-7點"
        "2C" - "4+C支持"
        "2D" - "5+D，5-9點"
        "2H" - "4H支持"
        "2N" - "邀叫"
        "3D" - "好的6+D，邀叫"
    }

    "1S" - "4+S，可能非均衡型" {
        "1N" - "5-7點"
        "2C" - "4+C支持"
        "2D" - "5+D，5-9點"
        "2H" - "4H，開叫實力"
        "2S" - "4S支持"
        "2N" - "邀叫"
    }

    "1N" - "12-15點均衡型，可能有4張高花但雙張小牌另一高花" {
        "2C" - "示弱叫或邀叫接力"
        "2D" - "5+D，弱牌"
        "2N" - "邀叫"
        "3C" - "好的5+C，邀叫"
        "3D" - "好的6+D，邀叫"
        "3N" - "止叫"
    }

    "2C" - "6+C，12-15點" {
        "2D" - "5+D，5-9點"
        "2N" - "邀叫"
        "3C" - "5+C支持，邀叫"
    }

    "2D" - "4+D支持，12-15點"

    "2H" - "倒叫：4+H更長C，16+點" {
        "2S" - "4S，迫叫"
        "2N" - "示弱（5-9點）"
        "3C" - "C偏好"
        "3D" - "5+D"
        "3H" - "4H支持"
    }

    "2S" - "倒叫：4+S更長C，16+點" {
        "2N" - "示弱"
        "3C" - "C偏好"
        "3D" - "5+D"
        "3S" - "4S支持"
    }

    "2N" - "19-20點均衡型"

    "3C" - "6+C，好排組，15-18點"
    "3D" - "蹦跳叫牌：4D支持，D短排組，高限"
    "3H" - "蹦跳叫牌：4D支持，H短排組，高限"
    "3S" - "蹦跳叫牌：4D支持，S短排組，高限"
    "3N" - "16-18點，6-7張接近堅實C排組"
}

/**
 * 低花開叫後一副高花應叫的開叫者再叫
 */
private fun BiddingTree.oneMajorResponseAfterMinor() {
    "1S" - "4+S（如應叫為1H）"
    "1N" - "12-15點均衡型，無4張應叫花色支持"

    "2C" - "6+C，12-15點" {
        "2D" - "第四花色排組迫叫"
    }

    // 簡單加叫（低限）
    "2H" - "4張H支持，12-15點（如應叫為1H）"
    "2S" - "4張S支持，12-15點（如應叫為1S）"

    "2N" - "19-20點均衡型，無4張應叫花色支持，另一高花可能4張"

    // 跳加叫（邀叫性）
    "3H" - "4張H支持，非均衡型，15-18點（如應叫為1H）"
    "3S" - "4張S支持，非均衡型，15-18點（如應叫為1S）"

    // 蹦跳叫牌（高限可成局）
    "3D" - "蹦跳叫牌（跳倒叫）：4張應叫花色支持，D短排組，19+點"
    // 1C-1H-3D = 4H支持，D短排組
    // 1C-1S-3D = 4S支持，D短排組
    // 1C-1S-3H = 4S支持，H短排組

    // 直接進局（高限均衡型）
    "4H" - "4張H支持，均衡型，19+點（如應叫為1H）"
    "4S" - "4張S支持，均衡型，19+點（如應叫為1S）"

    "3N" - "16-18點，6-7張接近堅實C排組，應叫花色單張或雙張小"

    // 瓦魯許割裂叫牌
    "4C" - "瓦魯許割裂：6+C，4張應叫花色支持，滿貫意圖"
    "4D" - "瓦魯許割裂：6+C，4張應叫花色支持，成局力量無滿貫意圖"
}

/**
 * 反常低花加叫後的開叫者再叫
 */
private fun BiddingTree.invertedMinorRaise() {
    "2D" - "顯示D止張，12-13點" {
        "2H" - "顯示H止張"
        "2S" - "顯示S止張"
        "2N" - "低限，不迫叫"
        "3C" - "低限，不迫叫"
        "3N" - "接受邀叫"
    }

    "2H" - "顯示H止張，12-13點"
    "2S" - "顯示S止張，12-13點"

    "2N" - "14-15點均衡型，兩高花有止張" {
        "3C" - "低限，長排組C"
        "3N" - "接受邀叫"
        // 三副新花色為滿貫試探扣叫
    }

    "3C" - "低限非均衡型，阻擊性再加叫"

    // 滿貫試探
    "3D" - "跳叫新花色：D短排組，滿貫意圖"
    "3H" - "跳叫新花色：H短排組，滿貫意圖"
    "3S" - "跳叫新花色：S短排組，滿貫意圖"
    "4C" - "RKC問叫（費爾德曼），C為將牌"
    "3N" - "19-20點均衡型"
}

/**
 * 費爾德曼2D應叫後
 */
private fun BiddingTree.feldman2D() {
    "2H" - "接力問叫" {
        "2S" - "6+D強排組"
        "2N" - "5-5雙低花"
    }
    "2N" - "4+H好排組（代替被佔用的2H）"
    "3C" - "C支持"
    "3D" - "3+D支持"
    "3N" - "19-20點均衡型，D至少2張"
    "4C" - "RKC問叫，C為將牌（5-5雙低花時）"
    "4D" - "RKC問叫，D為將牌（6+D強排組時）"
    "4H" - "H缺門，6+D強排組"
    "4S" - "S缺門，6+D強排組"
}
